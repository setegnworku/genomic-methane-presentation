<div id="progressBar" class="progress-bar"></div><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI + Genomics to Cut Livestock Methane</title>
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VPTYE7RK4M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-VPTYE7RK4M');
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #3730a3 0%, #4338ca 50%, #4f46e5 100%);
            color: white;
            overflow: hidden;
            height: 100vh;
        }

        .slideshow-container {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slide {
            display: none;
            width: 95%;
            max-width: 1400px;
            text-align: center;
            padding: 30px;
            animation: fadeIn 1s ease-in-out;
        }

        .slide.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-content h1 {
            font-size: 3.5rem;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            background: linear-gradient(45deg, #6366f1, #a5b4fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .slide-content h2 {
            font-size: 2.8rem;
            margin-bottom: 25px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
            color: #c7d2fe;
        }

        .slide-content p {
            font-size: 1.8rem;
            line-height: 1.6;
            margin-bottom: 25px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .key-points {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin: 40px 0;
            text-align: left;
        }

        .point-card {
            background: rgba(199, 210, 254, 0.12);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 1px solid rgba(199, 210, 254, 0.18);
            transition: transform 0.3s ease;
        }

        .point-card:hover {
            transform: translateY(-10px);
        }

        .point-title {
            font-size: 1.8rem;
            font-weight: bold;
            color: #6366f1;
            margin-bottom: 15px;
        }

        .point-text {
            font-size: 1.4rem;
            line-height: 1.5;
            color: #c7d2fe;
        }

        .highlight-box {
            background: rgba(99, 102, 241, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            margin: 30px 0;
            border-left: 5px solid #6366f1;
            font-size: 1.5rem;
            line-height: 1.8;
        }

        .pathway-section {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 40px 0;
            gap: 30px;
        }

        .pathway-image {
            max-width: 500px;
            max-height: 300px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .pathway-text {
            flex: 1;
            text-align: left;
            font-size: 1.6rem;
            line-height: 1.6;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .result-card {
            background: rgba(99, 102, 241, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
            border: 1px solid rgba(99, 102, 241, 0.25);
        }

        .result-number {
            font-size: 2.2rem;
            font-weight: bold;
            color: #6366f1;
            margin-bottom: 10px;
        }

        .result-label {
            font-size: 1.2rem;
            color: #c7d2fe;
        }

        .controls {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            align-items: center;
            z-index: 1000;
        }

        .btn {
            background: rgba(99, 102, 241, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(99, 102, 241, 0.4);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: rgba(99, 102, 241, 0.4);
            transform: translateY(-2px);
        }

        .progress-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            height: 4px;
            background: #6366f1;
            transition: width 0.5s ease;
            z-index: 1000;
        }

        .speech-display {
            position: fixed;
            bottom: 100px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            max-width: 400px;
            z-index: 1000;
            border: 1px solid rgba(99, 102, 241, 0.25);
        }

        .speech-text {
            font-size: 1rem;
            line-height: 1.4;
            color: #6366f1;
        }

        .start-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .start-message {
            font-size: 2.2rem;
            text-align: center;
            margin-bottom: 30px;
            color: #6366f1;
        }

        .start-btn {
            background: linear-gradient(45deg, #6366f1, #c7d2fe);
            color: #3730a3;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .start-btn:hover {
            transform: scale(1.05);
        }

        .status {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(0,0,0,0.7);
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            z-index: 1000;
            border: 1px solid rgba(99, 102, 241, 0.25);
        }

        .highlight {
            color: #97BC62;
            font-weight: bold;
        }

        .emoji {
            font-size: 1.2em;
            margin-right: 8px;
        }

        @media (max-width: 768px) {
            .pathway-section {
                flex-direction: column;
            }
            
            .key-points {
                grid-template-columns: 1fr;
            }
            
            .slide-content h1 {
                font-size: 2.5rem;
            }
            
            .slide-content h2 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <!-- Status display -->
    <div id="status" class="status">Loading...</div>

    <!-- Start presentation overlay -->
    <div id="startOverlay" class="start-overlay">
        <div class="start-message">
            üß¨ AI + Genomics to Cut Livestock Methane<br>
            <small>A 4-minute research presentation with automatic narration</small>
        </div>
        <button id="startBtn" class="start-btn">üéµ Start Presentation</button>
    </div>
    
    <div class="slideshow-container">
        <!-- Slide 1: AI + Genomics Challenge -->
        <div id="slide0" class="slide active">
            <div class="slide-content">
                <h1><span class="emoji">üß†</span>AI + Genomics to Cut Livestock Methane</h1>
                
                <div class="key-points">
                    <div class="point-card">
                        <div class="point-title"><span class="emoji">üåç</span>Climate Challenge</div>
                        <div class="point-text">Livestock ‚Üí 40% of global methane emissions</div>
                    </div>
                    <div class="point-card">
                        <div class="point-title"><span class="emoji">üö®</span>Current Problem</div>
                        <div class="point-text">Urgent climate challenge, low prediction accuracy</div>
                    </div>
                    <div class="point-card">
                        <div class="point-title"><span class="emoji">üß†</span>Our Solution</div>
                        <div class="point-text">Deep learning + microbiome + host genomics</div>
                    </div>
                    <div class="point-card">
                        <div class="point-title"><span class="emoji">üìç</span>Application</div>
                        <div class="point-text">Methane & feed efficiency traits in sheep</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Slide 2: High-Dimensional Challenge -->
        <div id="slide1" class="slide">
            <div class="slide-content">
                <h2><span class="emoji">‚ö°</span>Solving the High-Dimensional Microbiome Challenge</h2>
                
                <div class="key-points">
                    <div class="point-card">
                        <div class="point-title"><span class="emoji">‚ö†Ô∏è</span>Challenge</div>
                        <div class="point-text">
                            ‚Ä¢ 240,000+ microbial features<br>
                            ‚Ä¢ Fewer than 1,000 animals
                        </div>
                    </div>
                    <div class="point-card">
                        <div class="point-title"><span class="emoji">üß†</span>Solution</div>
                        <div class="point-text">
                            ‚Ä¢ PCA for dimensionality reduction<br>
                            ‚Ä¢ Validated PCA with microbiability comparison
                        </div>
                    </div>
                    <div class="point-card">
                        <div class="point-title"><span class="emoji">‚úîÔ∏è</span>Validation Result</div>
                        <div class="point-text">PCA preserved biological signal</div>
                    </div>
                </div>
                
                <div class="highlight-box">
                    <strong>Key Innovation:</strong> We confirmed PCA effectiveness by comparing microbiability estimates between full microbial data and PCA components - ensuring biological information was retained while dramatically reducing computational complexity.
                </div>
            </div>
        </div>
        
        <!-- Slide 3: Deep Learning Results -->
        <div id="slide2" class="slide">
            <div class="slide-content">
                <h2><span class="emoji">üöÄ</span>Interpretable Deep Learning ‚Üí Better Genomic Prediction</h2>
                
                <div class="key-points">
                    <div class="point-card">
                        <div class="point-title"><span class="emoji">üîó</span>Biological Pathway Modeled:</div>
                        <div class="point-text"><strong>Host DNA ‚Üí PCA Microbiome ‚Üí Methane / RFI</strong></div>
                    </div>
                    <div class="point-card">
                        <div class="point-title"><span class="emoji">ü§ñ</span>Method:</div>
                        <div class="point-text">Bayesian Neural Network (Zhao et al., 2022, Genetics)<br>
                        <em>‚Äî Extends GBLUP with intermediate omics data</em></div>
                    </div>
                </div>
                
                <div class="pathway-section">
                    <img src="data:image/svg+xml,%3Csvg width='500' height='300' viewBox='0 0 500 300' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='500' height='300' fill='%23f8faff'/%3E%3C!-- DNA --%3E%3Cg transform='translate(40,80)'%3E%3Cpath d='M20 40Q20 20 40 20Q60 20 60 40Q60 60 40 60Q20 60 20 40Z' fill='%236366f1' stroke='%235d5fef' stroke-width='3'/%3E%3Cpath d='M25 30h30M25 35h30M25 40h30M25 45h30M25 50h30' stroke='%23c7d2fe' stroke-width='2'/%3E%3C/g%3E%3C!-- Arrow 1--%3E%3Cpath d='M140 120L180 120' stroke='%236366f1' stroke-width='4'/%3E%3Cpath d='M170 110L180 120L170 130' fill='%236366f1'/%3E%3C!-- Rumen Microbiome --%3E%3Ccircle cx='250' cy='120' r='50' fill='%23f9f9f9' stroke='%236366f1' stroke-width='3'/%3E%3C!-- Microbes --%3E%3Ccircle cx='230' cy='100' r='8' fill='%23f59e0b'/%3E%3Cellipse cx='270' cy='105' rx='15' ry='5' fill='%2310b981'/%3E%3Cellipse cx='240' cy='140' rx='10' ry='4' fill='%2306b6d4'/%3E%3Ccircle cx='265' cy='135' r='6' fill='%236b7280'/%3E%3Ccircle cx='225' cy='125' r='4' fill='%23ef4444'/%3E%3Cellipse cx='260' cy='115' rx='8' ry='3' fill='%23a5b4fc'/%3E%3C!-- Arrow 2--%3E%3Cpath d='M300 120L340 120' stroke='%236366f1' stroke-width='4'/%3E%3Cpath d='M330 110L340 120L330 130' fill='%236366f1'/%3E%3C!-- Sheep --%3E%3Cg transform='translate(360,60)'%3E%3Cellipse cx='40' cy='40' rx='35' ry='25' fill='%23fef3c7' stroke='%23d97706' stroke-width='2'/%3E%3Ccircle cx='30' cy='35' r='2' fill='%23374151'/%3E%3Ccircle cx='50' cy='35' r='2' fill='%23374151'/%3E%3Cpath d='M35 45Q40 50 45 45' stroke='%23374151' stroke-width='1' fill='none'/%3E%3Crect x='20' y='60' width='4' height='12' fill='%23d97706'/%3E%3Crect x='56' y='60' width='4' height='12' fill='%23d97706'/%3E%3Crect x='25' y='60' width='4' height='12' fill='%23d97706'/%3E%3Crect x='51' y='60' width='4' height='12' fill='%23d97706'/%3E%3C/g%3E%3C!-- Methane Cloud --%3E%3Cellipse cx='460' cy='80' rx='30' ry='20' fill='%23c7d2fe' stroke='%236366f1' stroke-width='2'/%3E%3Ctext x='460' y='85' text-anchor='middle' font-size='12' fill='%23374151'%3ECH4%3C/text%3E%3C!-- Labels --%3E%3Ctext x='90' y='180' text-anchor='middle' font-size='18' font-weight='bold' fill='%236366f1'%3EDNA%3C/text%3E%3Ctext x='250' y='190' text-anchor='middle' font-size='16' font-weight='bold' fill='%236366f1'%3ERumen%3C/text%3E%3Ctext x='250' y='210' text-anchor='middle' font-size='16' font-weight='bold' fill='%236366f1'%3EMicrobiome%3C/text%3E%3Ctext x='420' y='160' text-anchor='middle' font-size='18' font-weight='bold' fill='%236366f1'%3EMethane%3C/text%3E%3C/svg%3E" 
                         alt="DNA ‚Üí Rumen Microbiome ‚Üí Methane pathway" 
                         class="pathway-image"/>
                </div>
                
                <div class="results-grid">
                    <div class="result-card">
                        <div class="result-number">0.09 ‚Üí 0.30</div>
                        <div class="result-label">Methane (train-test)</div>
                    </div>
                    <div class="result-card">
                        <div class="result-number">0.15 ‚Üí 0.27</div>
                        <div class="result-label">Methane (5-fold CV)</div>
                    </div>
                    <div class="result-card">
                        <div class="result-number">0.25 ‚Üí 0.37</div>
                        <div class="result-label">Feed Efficiency (train-test)</div>
                    </div>
                    <div class="result-card">
                        <div class="result-number">0.25 ‚Üí 0.34</div>
                        <div class="result-label">Feed Efficiency (5-fold CV)</div>
                    </div>
                </div>
                
                <div class="highlight-box">
                    <span class="emoji">üå±</span><strong>Outcome:</strong> Permanent genetic gains for climate-smart livestock breeding
                </div>
            </div>
        </div>
        <!-- Slide 4: More Information -->
        <div id="slide3" class="slide">
            <div class="slide-content">
                <h2><span class="emoji">üìö</span>For More Information</h2>
                
                <div class="key-points">
                    <div class="point-card">
                        <div class="point-title"><span class="emoji">üìÑ</span>Full Research Paper</div>
                        <div class="point-text">Complete methodology, results, and detailed analysis available in the peer-reviewed publication</div>
                    </div>
                    <div class="point-card">
                        <div class="point-title"><span class="emoji">üåê</span>Interactive Results</div>
                        <div class="point-text">Explore the data and results:<br><strong>https://setalemu.shinyapps.io/genomics_app_deploy/</strong></div>
                    </div>
                    <div class="point-card">
                        <div class="point-title"><span class="emoji">üíª</span>Presentation Code</div>
                        <div class="point-text">Access the source code for this presentation on GitHub</div>
                    </div>
                    <div class="point-card">
                        <div class="point-title"><span class="emoji">üôè</span>Acknowledgments</div>
                        <div class="point-text">We thank the reviewers and editors for their valuable feedback that helped strengthen this work</div>
                    </div>
                </div>
                
                <div class="highlight-box">
                    <span class="emoji">üéØ</span><strong>Thank you!</strong> Questions welcome - advancing climate-smart livestock breeding through rigorous science.
                </div>
            </div>
        </div>
    </div>
    
    <div class="controls">
        <button id="stopBtn" class="btn">‚èπÔ∏è Stop</button>
        <button id="restartBtn" class="btn">üîÑ Restart</button>
        <button id="musicToggleBtn" class="btn">üéµ Audio On</button>
        <input type="range" id="volumeSlider" min="0" max="100" value="70" style="width: 100px; margin: 0 10px;">
    </div>
    
    <!-- Speech display -->
    <div id="speechTextContainer" class="speech-display">
        <h3>üó£Ô∏è Now Speaking:</h3>
        <div id="currentSpeechText" class="speech-text"></div>
    </div>

    <script>
        let currentSlide = 0;
        let totalSlides = 4;
        let isPlaying = false;
        let slideInterval;
        let speechSynth = window.speechSynthesis;
        let currentUtterance = null;
        let speechEnabled = true;
        let speechFinished = false;
        
        // Speech texts for each slide (your exact text)
        const speechTexts = [
            "Livestock produce around 40% of global methane emissions, a major contributor to climate change. But genomic prediction accuracy for methane and feed efficiency traits remains too low to drive impactful breeding. We developed a solution that integrates deep learning, rumen microbiome profiles, and host genomic data to improve prediction performance in sheep.",
            
            "A major challenge was working with over 240,000 microbial features from fewer than 1,000 animals. We used Principal Component Analysis to reduce dimensionality. But how could we be sure PCA preserved biological information? We validated it by comparing microbiability estimates from the full microbial data versus PCA components. The results confirmed that PCA effectively retained the biological signal.",
            
            "We then implemented a biologically-informed Bayesian neural network based on Zhao et al. (2022), which extends mixed models to include intermediate omics layers. Instead of fitting raw microbial features, we used PCA components as observed intermediates between host DNA and methane traits. Methane prediction accuracy increased from 0.09 to 0.30 in train-test and 0.15 to 0.27 in cross-validation. Feed efficiency showed similar improvements. This interpretable framework helps enable permanent, scalable genetic progress toward climate-resilient livestock.",
            
            "For more information about this research, please see our full paper with complete methodology and detailed analysis. You can explore the interactive results and data at our Shiny application. The source code for this presentation is available on GitHub. We thank the reviewers and editors for their valuable feedback that helped strengthen this work. Thank you for your attention, and questions are welcome."
        ];
        
        // Slide durations in seconds
        const slideDurations = [60, 60, 90, 45];
        
        function updateStatus(message) {
            document.getElementById('status').textContent = message;
        }
        
        function updateProgressBar() {
            const progress = ((currentSlide + 1) / totalSlides) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }
        
        function showSlide(n) {
            const slides = document.querySelectorAll('.slide');
            
            if (n >= totalSlides) {
                stopPresentation();
                return;
            }
            
            if (n < 0) {
                n = 0;
            }
            
            slides.forEach(slide => slide.classList.remove('active'));
            
            if (slides[n]) {
                slides[n].classList.add('active');
                currentSlide = n;
                updateProgressBar();
                updateStatus(`Slide ${currentSlide + 1} of ${totalSlides}`);
                
                // Track slide views
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'slide_viewed', {
                        event_category: 'engagement',
                        event_label: `slide_${n + 1}`,
                        value: n + 1
                    });
                }
                
                if (speechEnabled && isPlaying) {
                    speakText(speechTexts[currentSlide]);
                }
            }
        }
        
        function speakText(text) {
            if (!text || !speechSynth) {
                console.log('Speech not available or no text provided');
                return;
            }
            
            if (speechSynth.speaking) {
                speechSynth.cancel();
            }
            
            const speechDisplay = document.getElementById('currentSpeechText');
            if (speechDisplay) {
                speechDisplay.textContent = text;
            }
            
            currentUtterance = new SpeechSynthesisUtterance(text);
            currentUtterance.rate = 0.9;
            currentUtterance.pitch = 1;
            
            const volumeSlider = document.getElementById('volumeSlider');
            if (volumeSlider) {
                currentUtterance.volume = volumeSlider.value / 100;
            } else {
                currentUtterance.volume = 0.7;
            }
            
            currentUtterance.onend = function() {
                speechFinished = true;
                if (isPlaying && currentSlide < totalSlides - 1) {
                    setTimeout(() => {
                        if (isPlaying) {
                            nextSlide();
                        }
                    }, 1000);
                } else if (currentSlide >= totalSlides - 1) {
                    stopPresentation();
                }
            };
            
            currentUtterance.onerror = function(event) {
                console.log('Speech error:', event);
                speechFinished = true;
                if (isPlaying) {
                    setTimeout(() => {
                        if (isPlaying) {
                            nextSlide();
                        }
                    }, slideDurations[currentSlide] * 1000);
                }
            };
            
            speechSynth.speak(currentUtterance);
            speechFinished = false;
        }
        
        function nextSlide() {
            if (currentSlide < totalSlides - 1) {
                showSlide(currentSlide + 1);
            } else {
                stopPresentation();
            }
        }
        
        function startPresentation() {
            isPlaying = true;
            currentSlide = 0;
            document.getElementById('startOverlay').style.display = 'none';
            updateStatus('Presentation running...');
            showSlide(0);
            
            // Track presentation start
            if (typeof gtag !== 'undefined') {
                gtag('event', 'presentation_started', {
                    event_category: 'engagement',
                    event_label: 'genomic_methane_presentation'
                });
            }
        }
        
        function stopPresentation() {
            isPlaying = false;
            clearInterval(slideInterval);
            if (speechSynth.speaking) {
                speechSynth.cancel();
            }
            updateStatus('Presentation stopped');
            document.getElementById('currentSpeechText').textContent = 'Presentation stopped.';
            
            // Track presentation completion
            if (typeof gtag !== 'undefined') {
                gtag('event', 'presentation_completed', {
                    event_category: 'engagement',
                    event_label: 'genomic_methane_presentation',
                    value: currentSlide + 1
                });
            }
        }
        
        function restartPresentation() {
            stopPresentation();
            currentSlide = 0;
            updateProgressBar();
            showSlide(0);
            document.getElementById('startOverlay').style.display = 'flex';
        }
        
        function toggleSpeech() {
            speechEnabled = !speechEnabled;
            const btn = document.getElementById('musicToggleBtn');
            
            if (!btn) return;
            
            if (speechEnabled) {
                btn.textContent = 'üéµ Audio On';
                if (isPlaying && !speechSynth.speaking && speechTexts[currentSlide]) {
                    speakText(speechTexts[currentSlide]);
                }
                
                // Track audio enabled
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'audio_enabled', {
                        event_category: 'interaction',
                        event_label: 'speech_synthesis'
                    });
                }
            } else {
                btn.textContent = 'üîá Audio Off';
                if (speechSynth.speaking) {
                    speechSynth.cancel();
                }
                const speechDisplay = document.getElementById('currentSpeechText');
                if (speechDisplay) {
                    speechDisplay.textContent = 'Audio disabled.';
                }
                
                // Track audio disabled
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'audio_disabled', {
                        event_category: 'interaction',
                        event_label: 'speech_synthesis'
                    });
                }
            }
        }
        
        // Event listeners
        document.getElementById('startBtn').addEventListener('click', startPresentation);
        document.getElementById('stopBtn').addEventListener('click', stopPresentation);
        document.getElementById('restartBtn').addEventListener('click', restartPresentation);
        document.getElementById('musicToggleBtn').addEventListener('click', toggleSpeech);
        
        // Volume control
        document.getElementById('volumeSlider').addEventListener('input', function() {
            if (currentUtterance) {
                currentUtterance.volume = this.value / 100;
            }
        });
        
        // Keyboard controls
        document.addEventListener('keydown', function(e) {
            switch(e.key) {
                case ' ':
                case 'Enter':
                    e.preventDefault();
                    if (!isPlaying) {
                        startPresentation();
                    }
                    break;
                case 'Escape':
                    stopPresentation();
                    break;
                case 'r':
                case 'R':
                    restartPresentation();
                    break;
                case 'm':
                case 'M':
                    toggleSpeech();
                    break;
                case 'ArrowRight':
                    if (!isPlaying && currentSlide < totalSlides - 1) {
                        showSlide(currentSlide + 1);
                    }
                    break;
                case 'ArrowLeft':
                    if (!isPlaying && currentSlide > 0) {
                        showSlide(currentSlide - 1);
                    }
                    break;
            }
        });
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateStatus('Ready to start presentation');
            updateProgressBar();
            
            // Check speech synthesis support
            if (!window.speechSynthesis) {
                updateStatus('Speech synthesis not supported');
                const musicBtn = document.getElementById('musicToggleBtn');
                if (musicBtn) {
                    musicBtn.style.display = 'none';
                }
            }
        });
        
        // Fallback initialization if DOMContentLoaded already fired
        if (document.readyState === 'loading') {
            // Wait for DOMContentLoaded
        } else {
            // DOM is already ready
            updateStatus('Ready to start presentation');
            updateProgressBar();
            
            if (!window.speechSynthesis) {
                updateStatus('Speech synthesis not supported');
                const musicBtn = document.getElementById('musicToggleBtn');
                if (musicBtn) {
                    musicBtn.style.display = 'none';
                }
            }
        }
    </script>
</body>
</html>
